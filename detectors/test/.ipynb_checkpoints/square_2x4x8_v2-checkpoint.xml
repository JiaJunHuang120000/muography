  <!-- SPDX-License-Identifier: LGPL-3.0-or-later -->
<!-- Copyright (C) 2024 Ryan Milton -->
<lccdd>
  <info name="muography"
        title="SiPM-on-Tile Muography Muon Detection"
        author="@jiajunhuang120000"
        url="https://github.com/jiajunhuang120000/muography"
        status="development"
        version="1.0"
        ><comment/></info>
<!-- Standard environmental conditions: 20 Â°C, 1 atm -->
<std_conditions type="NTP"/>

<includes>
    <gdmlFile ref="${DD4hepINSTALL}/DDDetectors/compact/elements.xml"/>
    <gdmlFile ref="${DETECTOR_PATH}/compact/materials.xml"/>
</includes>

  <display>
    <include ref="${DETECTOR_PATH}/compact/colors.xml"/>
  </display>

  <define>
    <constant name="Pi" value="3.14159265359"/>
    <constant name="mil" value="0.0254*mm"/>
    <constant name="inch" value="2.54*cm"/>
  </define>



  <define>
    <documentation>
      #### Material Thicknesses
    </documentation>
    <constant name="Detector_PolystyreneThickness"          value="4.88*cm"/>

    <documentation>
      - ZDC N Layers and computed Thickness
    </documentation>
      
    <constant name="Detector_PolystyreneWidth" value= "4.88*cm"/>
    <constant name="Detector_PolystyreneHeight" value= "0.4*cm"/>
      
    <constant name="Detector_length" value= "(Detector_PolystyreneThickness+0.1*cm)*8"/>
    <constant name="Detector_rotateX_angle" value="0*deg"/>
    <constant name="Detector_rotateY_angle" value="0*deg"/>
    <constant name="Detector_rotateZ_angle" value="0*deg"/>
    <constant name="Detector_angle" value="90*deg"/>
    
    <constant name="Detector_radius" value="2.7*cm"/>
  </define>
    
  <detectors>
    <detector
      id="0"
      name="Pathch0"
      type="ZeroDegreeCalorimeterSiPMonTile"
      readout="MuographyHits"
      vis="InvisibleWithDaughters"
    >
      <position x="Detector_x_pos+Detector_radius*sin(Detector_angle*0+45*deg)"         y="Detector_y_pos+Detector_radius*sin(Detector_angle*0+45*deg)"         z="Detector_z_pos-1.22*cm+Detector_length/2+4.88*cm+1.5*cm"/>
      <rotation x="Detector_rotateX_angle" y="Detector_rotateY_angle" z="Detector_rotateZ_angle-Detector_angle*0-45*deg"/>
      <dimensions
        x="Detector_PolystyreneWidth"
        y="Detector_PolystyreneHeight"
        z="Detector_length"
      />
      <layer repeat="8" thickness="Detector_PolystyreneThickness+0.1*cm" vis="InvisibleWithDaughters" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight">
        <slice name="Scintillator_slice" material="Polystyrene" thickness="Detector_PolystyreneThickness" vis="AnlOrange" sensitive="true" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
        <slice name="Vacuum" material="Vacuum" thickness="0.1*cm" vis="AnlGray" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
      </layer>
    </detector>

    <detector
      id="1"
      name="Pathch1"
      type="ZeroDegreeCalorimeterSiPMonTile"
      readout="MuographyHits"
      vis="InvisibleWithDaughters"
    >
      <position x="Detector_x_pos+Detector_radius*sin(Detector_angle*1+45*deg)"         y="Detector_y_pos+Detector_radius*sin(Detector_angle*1+45*deg)"         z="Detector_z_pos-2.44*cm+Detector_length/2+4.88*cm+1.5*cm"/>
      <rotation x="Detector_rotateX_angle" y="Detector_rotateY_angle" z="Detector_rotateZ_angle-Detector_angle*1-45*deg"/>
      <dimensions
        x="Detector_PolystyreneWidth"
        y="Detector_PolystyreneHeight"
        z="Detector_length"
      />
      <layer repeat="8" thickness="Detector_PolystyreneThickness+0.1*cm" vis="InvisibleWithDaughters" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight">
        <slice name="Scintillator_slice" material="Polystyrene" thickness="Detector_PolystyreneThickness" vis="AnlOrange" sensitive="true" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
        <slice name="Vacuum" material="Vacuum" thickness="0.1*cm" vis="AnlGray" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>

      </layer>
    </detector>

    <detector
      id="2"
      name="Pathch2"
      type="ZeroDegreeCalorimeterSiPMonTile"
      readout="MuographyHits"
      vis="InvisibleWithDaughters"
    >
      <position x="Detector_x_pos+Detector_radius*sin(Detector_angle*2+45*deg)"         y="Detector_y_pos+Detector_radius*sin(Detector_angle*2+45*deg)"         z="Detector_z_pos-3.66*cm+Detector_length/2+4.88*cm+1.5*cm"/>
      <rotation x="Detector_rotateX_angle" y="Detector_rotateY_angle" z="Detector_rotateZ_angle-Detector_angle*2-45*deg"/>
      <dimensions
        x="Detector_PolystyreneWidth"
        y="Detector_PolystyreneHeight"
        z="Detector_length"
      />
      <layer repeat="8" thickness="Detector_PolystyreneThickness+0.1*cm" vis="InvisibleWithDaughters" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight">
        <slice name="Scintillator_slice" material="Polystyrene" thickness="Detector_PolystyreneThickness" vis="AnlOrange" sensitive="true" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
        <slice name="Vacuum" material="Vacuum" thickness="0.1*cm" vis="AnlGray" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>

      </layer>
    </detector>

    <detector
      id="3"
      name="Pathch3"
      type="ZeroDegreeCalorimeterSiPMonTile"
      readout="MuographyHits"
      vis="InvisibleWithDaughters"
    >
      <position x="Detector_x_pos+Detector_radius*sin(Detector_angle*3+45*deg)"         y="Detector_y_pos+Detector_radius*sin(Detector_angle*3+45*deg)"         z="Detector_z_pos-4.88*cm+Detector_length/2+4.88*cm+1.5*cm"/>
      <rotation x="Detector_rotateX_angle" y="Detector_rotateY_angle" z="Detector_rotateZ_angle-Detector_angle*3-45*deg"/>
      <dimensions
        x="Detector_PolystyreneWidth"
        y="Detector_PolystyreneHeight"
        z="Detector_length"
      />
      <layer repeat="8" thickness="Detector_PolystyreneThickness+0.1*cm" vis="InvisibleWithDaughters" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight">
        <slice name="Scintillator_slice" material="Polystyrene" thickness="Detector_PolystyreneThickness" vis="AnlOrange" sensitive="true" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
        <slice name="Vacuum" material="Vacuum" thickness="0.1*cm" vis="AnlGray" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>

      </layer>
    </detector>


    <detector
      id="4"
      name="Pathch4"
      type="ZeroDegreeCalorimeterSiPMonTile"
      readout="MuographyHits"
      vis="InvisibleWithDaughters"
    >
      <position x="Detector_x_pos+Detector_radius*sin(Detector_angle*0)"         y="Detector_y_pos+Detector_radius*sin(Detector_angle*0)"         z="Detector_z_pos-1.22*cm-Detector_length/2-1.5*cm"/>
      <rotation x="Detector_rotateX_angle" y="Detector_rotateY_angle" z="Detector_rotateZ_angle-Detector_angle*0"/>
      <dimensions
        x="Detector_PolystyreneWidth"
        y="Detector_PolystyreneHeight"
        z="Detector_length"
      />
      <layer repeat="8" thickness="Detector_PolystyreneThickness+0.1*cm" vis="InvisibleWithDaughters" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight">
        <slice name="Scintillator_slice" material="Polystyrene" thickness="Detector_PolystyreneThickness" vis="AnlOrange" sensitive="true" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
        <slice name="Vacuum" material="Vacuum" thickness="0.1*cm" vis="AnlGray" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
      </layer>
    </detector>

    <detector
      id="5"
      name="Pathch5"
      type="ZeroDegreeCalorimeterSiPMonTile"
      readout="MuographyHits"
      vis="InvisibleWithDaughters"
    >
      <position x="Detector_x_pos+Detector_radius*sin(Detector_angle*1)"         y="Detector_y_pos+Detector_radius*sin(Detector_angle*1)"         z="Detector_z_pos-2.44*cm-Detector_length/2-1.5*cm"/>
      <rotation x="Detector_rotateX_angle" y="Detector_rotateY_angle" z="Detector_rotateZ_angle-Detector_angle*1"/>
      <dimensions
        x="Detector_PolystyreneWidth"
        y="Detector_PolystyreneHeight"
        z="Detector_length"
      />
      <layer repeat="8" thickness="Detector_PolystyreneThickness+0.1*cm" vis="InvisibleWithDaughters" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight">
        <slice name="Scintillator_slice" material="Polystyrene" thickness="Detector_PolystyreneThickness" vis="AnlOrange" sensitive="true" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
        <slice name="Vacuum" material="Vacuum" thickness="0.1*cm" vis="AnlGray" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>

      </layer>
    </detector>

    <detector
      id="6"
      name="Pathch6"
      type="ZeroDegreeCalorimeterSiPMonTile"
      readout="MuographyHits"
      vis="InvisibleWithDaughters"
    >
      <position x="Detector_x_pos+Detector_radius*sin(Detector_angle*2)"         y="Detector_y_pos+Detector_radius*sin(Detector_angle*2)"         z="Detector_z_pos-3.66*cm-Detector_length/2-1.5*cm"/>
      <rotation x="Detector_rotateX_angle" y="Detector_rotateY_angle" z="Detector_rotateZ_angle-Detector_angle*2"/>
      <dimensions
        x="Detector_PolystyreneWidth"
        y="Detector_PolystyreneHeight"
        z="Detector_length"
      />
      <layer repeat="8" thickness="Detector_PolystyreneThickness+0.1*cm" vis="InvisibleWithDaughters" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight">
        <slice name="Scintillator_slice" material="Polystyrene" thickness="Detector_PolystyreneThickness" vis="AnlOrange" sensitive="true" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
        <slice name="Vacuum" material="Vacuum" thickness="0.1*cm" vis="AnlGray" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>

      </layer>
    </detector>

    <detector
      id="7"
      name="Pathch7"
      type="ZeroDegreeCalorimeterSiPMonTile"
      readout="MuographyHits"
      vis="InvisibleWithDaughters"
    >
      <position x="Detector_x_pos+Detector_radius*sin(Detector_angle*3)"         y="Detector_y_pos+Detector_radius*sin(Detector_angle*3)"         z="Detector_z_pos-4.88*cm-Detector_length/2-1.5*cm"/>
      <rotation x="Detector_rotateX_angle" y="Detector_rotateY_angle" z="Detector_rotateZ_angle-Detector_angle*3"/>
      <dimensions
        x="Detector_PolystyreneWidth"
        y="Detector_PolystyreneHeight"
        z="Detector_length"
      />
      <layer repeat="8" thickness="Detector_PolystyreneThickness+0.1*cm" vis="InvisibleWithDaughters" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight">
        <slice name="Scintillator_slice" material="Polystyrene" thickness="Detector_PolystyreneThickness" vis="AnlOrange" sensitive="true" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>
        <slice name="Vacuum" material="Vacuum" thickness="0.1*cm" vis="AnlGray" width="Detector_PolystyreneWidth" height="Detector_PolystyreneHeight" x_offset="0*cm" y_offset="0*cm"/>

      </layer>
    </detector>
      
  </detectors>

  <readouts>
    <readout name="MuographyHits">
      <segmentation
        type="CartesianGridXYStaggered"
        grid_size_x="4.88*cm"
        grid_size_y="4.88*cm"
        stagger_x="0"
        stagger_y="0"
        />
      <id>system:8,layer:8,slice:2,x:32:-16,y:-16</id>
    </readout>
  </readouts>

</lccdd>
